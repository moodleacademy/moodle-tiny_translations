define("tiny_translations/commands",["exports","editor_tiny/utils","core/str","./ui","./common","./options"],(function(_exports,_utils,_str,_ui,_common,_options){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0;_exports.getSetup=async()=>{const[buttonText,buttonImage]=await Promise.all([(0,_str.get_string)("buttontitle",_common.component),(0,_utils.getButtonImage)("icon",_common.component)]);return editor=>{if(editor.ui.registry.addIcon(_common.icon,buttonImage.html),editor.ui.registry.addToggleButton(_common.buttonName,{icon:_common.icon,tooltip:buttonText,onAction:()=>(0,_ui.handleAction)(editor)}),"id_substitutetext_editor"===editor.getElement().id)return;let translationHashElement;editor.on("init",(()=>{const newTranslationHash=(0,_options.getUnusedHash)(editor);if(newTranslationHash)if(translationHashElement=editor.getBody().querySelector("[data-translationhash]"),translationHashElement){if(!translationHashElement.parentElement.classList.contains("translationhash")){var _translationHashEleme;const translationHash=null===(_translationHashEleme=translationHashElement)||void 0===_translationHashEleme?void 0:_translationHashEleme.dataset.translationhash;translationHashElement.remove(),translationHashElement=insertTranslationHash(editor,translationHash)}}else translationHashElement=insertTranslationHash(editor,newTranslationHash)})),editor.on("submit",(()=>{editor.getContent()===translationHashElement.outerHTML&&editor.setContent(""),editor.save()}))}};const insertTranslationHash=(editor,translationHash)=>{const translationHashElement=(translationHash=>{const translationHashElement=document.createElement("span");translationHashElement.dataset.translationhash=translationHash;const parentBlock=document.createElement("p");return parentBlock.setAttribute("class","translationhash"),parentBlock.appendChild(translationHashElement),parentBlock})(translationHash);return editor.getBody().prepend(translationHashElement),translationHashElement}}));

//# sourceMappingURL=commands.min.js.map