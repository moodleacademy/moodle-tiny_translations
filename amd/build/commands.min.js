define("tiny_translations/commands",["exports","editor_tiny/utils","core/str","./ui","./common","./options"],(function(_exports,_utils,_str,_ui,_common,_options){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0;_exports.getSetup=async()=>{const[buttonText,buttonImage]=await Promise.all([(0,_str.get_string)("buttontitle",_common.component),(0,_utils.getButtonImage)("icon",_common.component)]);return editor=>{if("id_substitutetext_editor"===editor.getElement().id)return;let translationHash,translationHashElement;editor.ui.registry.addIcon(_common.icon,buttonImage.html),editor.ui.registry.addToggleButton(_common.buttonName,{icon:_common.icon,tooltip:buttonText,onAction:()=>(0,_ui.handleAction)(editor)}),editor.on("init",(()=>{const newTranslationHash=(0,_options.getUnusedHash)(editor);if(!newTranslationHash)return;let translationHashSpan;if(translationHashSpan=editor.getBody().querySelector("[data-translationhash]"),translationHashSpan){var _translationHashSpan2,_translationHashSpan;if(!translationHashSpan.parentElement.classList.contains("translationhash"))translationHash=null===(_translationHashSpan=translationHashSpan)||void 0===_translationHashSpan?void 0:_translationHashSpan.dataset.translationhash,translationHashSpan.remove(),translationHashElement=(0,_ui.insertTranslationHash)(editor,translationHash);translationHashElement=translationHashSpan.parentElement,translationHash=null===(_translationHashSpan2=translationHashSpan)||void 0===_translationHashSpan2?void 0:_translationHashSpan2.dataset.translationhash}else{var _translationHashEleme;translationHashElement=(0,_ui.insertTranslationHash)(editor,newTranslationHash),translationHash=null===(_translationHashEleme=translationHashElement)||void 0===_translationHashEleme?void 0:_translationHashEleme.firstElementChild.dataset.translationhash}})),editor.on("submit",(()=>{(0,_ui.findTranslationHashElements)(editor,editor.getContent())||(translationHashElement=(0,_ui.insertTranslationHash)(editor,translationHash)),editor.getContent()===translationHashElement.outerHTML&&editor.setContent(""),editor.save()}))}}}));

//# sourceMappingURL=commands.min.js.map